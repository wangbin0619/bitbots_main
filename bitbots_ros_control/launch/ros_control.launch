<?xml version="1.0"?>
<launch>
    <arg name="sim" default="false"/>
    <arg name="use_game_settings" default="false"/>
    <arg name="torqueless_mode" default="false"/>
    <arg name="only_imu" default="false"/>
    <arg name="only_pressure" default="false"/>

    <arg if="$(env IS_ROBOT false)" name="taskset" default="taskset -c 0"/>
    <arg unless="$(env IS_ROBOT false)" name="taskset" default=""/>

    <param from="$(find-pkg-share bitbots_ros_control)/config/wolfgang.yaml" command="load" />
    <param from="$(find-pkg-share bitbots_ros_control)/config/controller.yaml" command="load" />


    <param name="/ros_control/torqueless_mode" value="$(var torqueless_mode)"/>
    <param name="/ros_control/only_imu" value="$(var only_imu)"/>
    <param name="/ros_control/only_pressure" value="$(var only_pressure)"/>

    <node pkg="bitbots_ros_control" exec="node" name="ros_control" output="screen" launch-prefix="$(var taskset)"/>

    <group if="$(var use_game_settings)">
        <rosparam command="load" file="$(find-pkg-share bitbots_bringup)/config/game_settings.yaml" />
    </group>


    <node pkg="diagnostic_aggregator" exec="aggregator_node" name="diagnostic_aggregator" >
        <rosparam command="load" file="$(find-pkg-share bitbots_ros_control)/config/analyzers.yaml" />
    </node>

    <node pkg="bitbots_ros_control" exec="led_error_blink.py" name="error_blink"/>

    <include file="$(find-pkg-share system_monitor)/launch/system_monitor.launch"/>

    <include file="$(find-pkg-share bitbots_buttons)/launch/buttons.launch"/>

    <include file="$(find-pkg-share humanoid_league_speaker)/launch/speaker.launch"/>

    <include file="$(find-pkg-share bitbots_ros_control)/launch/pressure_converter.launch"/>

    <node pkg="bitbots_ros_control" name="button_zero" exec="zero_on_button.py"/>

    <node pkg="bitbots_ros_control" name="battery_led" exec="battery_led.py"/>

</launch>

